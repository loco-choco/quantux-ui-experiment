[gd_scene load_steps=9 format=3 uid="uid://dg2eoqojt8v1"]

[ext_resource type="Script" uid="uid://dqcm57s62snqt" path="res://scripts/main.gd" id="1_o5qli"]
[ext_resource type="PackedScene" uid="uid://ct5lh45t375b1" path="res://scenes/world.tscn" id="2_0wfyh"]

[sub_resource type="LabelSettings" id="LabelSettings_tefeu"]
font_size = 12

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_tefeu"]

[sub_resource type="StyleBoxLine" id="StyleBoxLine_jyhfs"]
color = Color(0.099985994, 0.099985994, 0.099985994, 1)
grow_begin = 30.0
grow_end = 30.0
thickness = 5

[sub_resource type="StyleBoxLine" id="StyleBoxLine_sugp2"]
color = Color(0.3741394, 0.37413922, 0.37413922, 1)
grow_begin = 0.0
grow_end = 0.0
thickness = 3

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_sugp2"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_tbgi4"]

[node name="Main" type="Node2D"]
script = ExtResource("1_o5qli")
regular_world = ExtResource("2_0wfyh")
metadata/_edit_vertical_guides_ = [971.0, -288.0, 1027.0]
metadata/_edit_horizontal_guides_ = [586.0, -107.0]

[node name="MainMenuCanvas" type="CanvasLayer" parent="."]
process_mode = 3

[node name="MainMenu" type="PanelContainer" parent="MainMenuCanvas"]
unique_name_in_owner = true
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="MainMenuCanvas/MainMenu"]
layout_mode = 2
theme_override_constants/margin_left = 10
theme_override_constants/margin_top = 10
theme_override_constants/margin_right = 10
theme_override_constants/margin_bottom = 10

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/MainMenu/MarginContainer"]
layout_mode = 2

[node name="MarginContainer2" type="MarginContainer" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/margin_left = 150
theme_override_constants/margin_right = 150

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer2"]
layout_mode = 2

[node name="Title" type="Label" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer2/VBoxContainer"]
layout_mode = 2
text = "Quant UX Inventory Experiement"
horizontal_alignment = 1

[node name="Description" type="Label" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer2/VBoxContainer"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
text = "This is a game for the research project from the class Quant UX (HSS_0EL42) from Telecom Paris. In it, the user (you) is tasked to play the game as you seem fit. Metrics will be collected during the gameplay, as described by the survey in the first button. If you agree to share it with the research project, please follow the instructions given by the questionnaire, if not, fell free to just play the game, no data will be sent without your knowledge or consent."
label_settings = SubResource("LabelSettings_tefeu")
horizontal_alignment = 1
autowrap_mode = 2

[node name="HSeparator" type="HSeparator" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 100
theme_override_styles/separator = SubResource("StyleBoxEmpty_tefeu")

[node name="MarginContainer" type="MarginContainer" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/margin_left = 200
theme_override_constants/margin_right = 200

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer"]
layout_mode = 2

[node name="EnableDataCollection" type="CheckButton" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer"]
visible = false
layout_mode = 2
text = "Enable Data Collection"

[node name="OpenQuestionnaire" type="Button" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Open Survey"

[node name="OpenTutorial" type="Button" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Open Tutorial"

[node name="StartGame" type="Button" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Play Round"

[node name="ExportData" type="Button" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Export Collected Data"

[node name="ExitGame" type="Button" parent="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Exit Game"

[node name="RoundSumary" type="PanelContainer" parent="MainMenuCanvas"]
unique_name_in_owner = true
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="MainMenuCanvas/RoundSumary"]
layout_mode = 2
theme_override_constants/margin_left = 10
theme_override_constants/margin_top = 10
theme_override_constants/margin_right = 10
theme_override_constants/margin_bottom = 10

[node name="CenterContainer" type="CenterContainer" parent="MainMenuCanvas/RoundSumary/MarginContainer"]
layout_mode = 2

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer"]
layout_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/margin_left = 200
theme_override_constants/margin_right = 200

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer"]
layout_mode = 2

[node name="GameOver" type="Label" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "You died!
Game Over!"
horizontal_alignment = 1

[node name="GameWon" type="VBoxContainer" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2

[node name="TextAbove" type="Label" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer/GameWon"]
layout_mode = 2
text = "You won with"
horizontal_alignment = 1

[node name="Score" type="Label" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer/GameWon"]
unique_name_in_owner = true
layout_mode = 2
text = "100"
horizontal_alignment = 1

[node name="TextBellow" type="Label" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer/GameWon"]
layout_mode = 2
text = "points!"
horizontal_alignment = 1

[node name="RoundSumaryReturn" type="Button" parent="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Return to Menu"

[node name="Tutorial" type="PanelContainer" parent="MainMenuCanvas"]
unique_name_in_owner = true
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="ScrollContainer" type="ScrollContainer" parent="MainMenuCanvas/Tutorial"]
layout_mode = 2
horizontal_scroll_mode = 0
vertical_scroll_mode = 2

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer"]
layout_mode = 2
size_flags_horizontal = 3

[node name="MarginContainer" type="MarginContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/margin_left = 100
theme_override_constants/margin_top = 25
theme_override_constants/margin_right = 100

[node name="VBoxContainer" type="VBoxContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer"]
layout_mode = 2

[node name="Title" type="Label" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
text = "Tutorial"
horizontal_alignment = 1

[node name="HSeparator" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxLine_jyhfs")

[node name="Objective" type="VBoxContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="Title" type="Label" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Objective"]
layout_mode = 2
text = "Objective"
horizontal_alignment = 1

[node name="HSeparator2" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Objective"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxLine_sugp2")

[node name="Description" type="RichTextLabel" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Objective"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
theme_override_font_sizes/normal_font_size = 14
theme_override_font_sizes/bold_font_size = 14
theme_override_font_sizes/bold_italics_font_size = 14
theme_override_font_sizes/italics_font_size = 14
theme_override_font_sizes/mono_font_size = 14
text = "Your objective is to get the highest amount of valuable items inside your inventory (also called \"bag\") while surviving to the end of the round. 
A round is composed of several waves of enemies that will swarm you, with each wave getting increasingly more difficult.
Each item has an amount of points associated with it, and it is your job to decide which ones are better to be kept or to be left on the floor."
fit_content = true
autowrap_mode = 2

[node name="HSeparator3" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Objective"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxEmpty_sugp2")

[node name="Controls" type="VBoxContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="Title" type="Label" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Controls"]
layout_mode = 2
text = "Controls"
horizontal_alignment = 1

[node name="HSeparator2" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Controls"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxLine_sugp2")

[node name="Description" type="RichTextLabel" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Controls"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
theme_override_font_sizes/normal_font_size = 14
theme_override_font_sizes/bold_font_size = 14
theme_override_font_sizes/bold_italics_font_size = 14
theme_override_font_sizes/italics_font_size = 14
theme_override_font_sizes/mono_font_size = 14
bbcode_enabled = true
text = "[center][b]IN GAME[/b][/center]

[center]MOVEMENT[/center]
Use WASD/ZQSD to move the player.

[center]SHOOTING[/center]
While using your mouse to aim (from the center of the screen, the bullet goes in the direction of the mouse pointer), press LEFT MOUSE to fire your primary weapon, and RIGHT MOUSE to fire your secondary weapon.

[center]INTERACTING WITH ITEMS[/center]
You will find items scattered on the ground as small squares that will be highlighted once you are close enough to interact with. By pressing E they will be automatically placed in your bag, if there is enough space left. If there isn't enough space, the item will stay on the ground, and you will have to either drop or rearrange your current inventory to have it fit.

[center]OPENING THE INVENTORY[/center]
Press SPACE to open the inventory.

[center][b]IN THE INVENTORY[/b][/center]

[center]INTERACTING WITH ITEMS[/center]
With your mouse, hover the item and press LEFT MOUSE to grab it. You can then press RIGHT MOUSE to rotate it, and LEFT MOUSE again to place it in a new position that depends on where you move your mouse. Invalid slots will be marked with red and won't allow you to place items in there.

You can also press RIGHT MOUSE before grabbing an item to see other interaction options like:
- Drop: Drops the item to the ground, removing it from the inventory
- Heal (x): Heals the player for an x amount
- Value (x): The value (x) of the item

[center]EQUIPPING WEAPONS[/center]
Once you have a weapon, you can equip it in your primary or secondary weapon slots. Those slots are big white rectangles located to the left of the inventory, with the first at the top being the primary weapons, and the second for secondary weapons.
These slots only accept weapons, and will turn red if the item you are holding isn't one.

[center]DROPPING ITEMS[/center]
You can drop an item by either pressing RIGHT MOUSE and then \"Drop\" or, or by grabbing it with LEFT MOUSE and placing it in the \"Drop Slot\", which will appear as a big downward arrow to the right of the inventory.

[center]CLOSING THE INVENTORY[/center]
Press SPACE to close back the inventory. Any items you were holding will be dropped back to the floor if there isn't any space available in the bag.


"
fit_content = true
autowrap_mode = 2

[node name="HSeparator3" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Controls"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxEmpty_sugp2")

[node name="Enemies" type="VBoxContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="Title" type="Label" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Enemies"]
layout_mode = 2
text = "Enemies"
horizontal_alignment = 1

[node name="HSeparator2" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Enemies"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxLine_sugp2")

[node name="Description" type="RichTextLabel" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Enemies"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
theme_override_font_sizes/normal_font_size = 14
theme_override_font_sizes/bold_font_size = 14
theme_override_font_sizes/bold_italics_font_size = 14
theme_override_font_sizes/italics_font_size = 14
theme_override_font_sizes/mono_font_size = 14
bbcode_enabled = true
text = "Enemies are the colored triangles characters that you will see chasing you down. They will try to get close to lend a hit on you, so be careful!
They are separated in 3 groups by color,  [color=red]RED[/color], [color=royal_blue]BLUE[/color] and [color=green]GREEN[/color]. 
They can only be efficiently harmed by the [b]right colored[/b] weapon/bullet, for example, a [color=red]RED[/color] enemy is only harmed by [color=red]RED[/color] weapons/bullets.
You [i]can[/i] kill all enemy types with any weapon type, but it will take a greater amount of bullets.
As the waves go on, they will be more numerous, faster, and more diverse, so use the time between the waves to heal and find new items that might aid you."
fit_content = true
autowrap_mode = 2

[node name="HSeparator3" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Enemies"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxEmpty_sugp2")

[node name="Items" type="VBoxContainer" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="Title" type="Label" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Items"]
layout_mode = 2
text = "Items"
horizontal_alignment = 1

[node name="HSeparator2" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Items"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxLine_sugp2")

[node name="Description" type="RichTextLabel" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Items"]
custom_minimum_size = Vector2(100, 0)
layout_mode = 2
theme_override_font_sizes/normal_font_size = 14
theme_override_font_sizes/bold_font_size = 14
theme_override_font_sizes/bold_italics_font_size = 14
theme_override_font_sizes/italics_font_size = 14
theme_override_font_sizes/mono_font_size = 14
bbcode_enabled = true
text = "Items are spread all over the map, and are separated in 3 categories: POTIONS, COINS and WEAPONS. All items have value, with some being more valuable than others. You can always check this information by pressing RIGHT MOUSE over the item of interest while in the inventory.

In general, the bigger the item (inside the inventory grid) the more value it can offer, either as a healing source, or points for the score.

[center]POTIONS[/center]
Potions are single use red vials that can heal the player for some amount. They can differ in size, heal amount, and value.

[center]COINS[/center]
Coins are small yellow circles that give a lot of points, and can differ in size and value.

[center]WEAPONS[/center]
Weapons are colored pistols. They all have the same size, and all the colors can be found scattered around the map.
Weapons are divided in 3 colors: [color=red]RED[/color], [color=royal_blue]BLUE[/color] and [color=green]GREEN[/color]. By equipping differently colored weapons in the primary and secondary weapon slots, you can shoot both colors when pressing MOUSE LEFT and MOUSE RIGHT. Enemies are only really affected by the right color, so pay attention to make the correct switch, although they can all be killed by any weapon.

[b]You start the game without a weapon, so searching the map for one is one of your first priorities.[/b]
"
fit_content = true
autowrap_mode = 2

[node name="HSeparator3" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/Items"]
layout_mode = 2
theme_override_constants/separation = 30
theme_override_styles/separator = SubResource("StyleBoxEmpty_sugp2")

[node name="HSeparator3" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 50
theme_override_styles/separator = SubResource("StyleBoxEmpty_tbgi4")

[node name="TutorialReturn" type="Button" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Return to Menu"

[node name="HSeparator2" type="HSeparator" parent="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 100
theme_override_styles/separator = SubResource("StyleBoxEmpty_tbgi4")

[connection signal="toggled" from="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer/EnableDataCollection" to="." method="_on_enable_data_collection_toggled"]
[connection signal="pressed" from="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer/OpenQuestionnaire" to="." method="_on_open_questionnaire"]
[connection signal="pressed" from="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer/OpenTutorial" to="." method="_on_tutorial_pressed"]
[connection signal="pressed" from="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer/StartGame" to="." method="_on_start_game_pressed"]
[connection signal="pressed" from="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer/ExportData" to="." method="_on_export_data_pressed"]
[connection signal="pressed" from="MainMenuCanvas/MainMenu/MarginContainer/VBoxContainer/MarginContainer/VBoxContainer/ExitGame" to="." method="_on_exit_game_pressed"]
[connection signal="pressed" from="MainMenuCanvas/RoundSumary/MarginContainer/CenterContainer/VBoxContainer/MarginContainer/VBoxContainer/RoundSumaryReturn" to="." method="_on_round_summary_return_pressed"]
[connection signal="pressed" from="MainMenuCanvas/Tutorial/ScrollContainer/VBoxContainer/MarginContainer/VBoxContainer/TutorialReturn" to="." method="_on_tutorial_return_pressed"]
